"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var $=require("jquery"),ajax_1=require("../../ui/components/ajax/ajax"),common_1=require("../../common/common"),PdSDKUtils=function(){function r(){}return r.ajax=function(e,t){void 0===t&&(t=!1);var n={error:r.ajaxError};return n=$.extend(!0,{},e,n),ajax_1.PdUIAjax.loader(n).then(function(e){var n=e.data,o=e.textStatus,a=e.jqXHR;return r.ajaxResultCheck(n,o,a,t)},function(r){var e=(r.jqXHR,r.textStatus);r.errorThrown;return Promise.reject(new Error(e))})},r.ajaxError=function(r,e,t){var n=r.responseJSON?r.responseJSON.ErrorInfo||r.responseJSON.msg||"":e;common_1.PdCommonUtils.error(n)},r.ajaxResultCheck=function(r,e,t,n){void 0===n&&(n=!1);var o="未知错误";try{if(r.code||r.ActionStatus){if(200===r.code||"OK"===r.ActionStatus)return Promise.resolve(r.data);o=r.msg||r.ErrorInfo||"未知错误"}}catch(a){}return n||common_1.PdCommonUtils.error(o),Promise.reject(new Error(o))},r.buildUrl=function(r,e){if(e&&!$.isEmptyObject(e)){var t=r.indexOf("?")>0?"&":"?";for(var n in e)e.hasOwnProperty(n)&&e[n]instanceof Array&&(e[n]=JSON.stringify(e[n]));return r+t+$.param(e)}return r},r.imgBuilder=function(r,e){return 0!==r.indexOf("http")&&e&&(r=e+r),r+"?_="+Math.floor((new Date).getTime()/36e5)},r.str2reg=function(r){return r.replace(new RegExp("(\\\\|\\+|\\-|\\?|\\.|\\*|\\(|\\)|\\||\\[|\\]|\\^|\\$)","gi"),"\\$1")},r.updateUrl=function(r,e){return r&&r.ajaxSettings&&r.ajaxSettings.url&&(e&&e.ajaxSettings&&e.ajaxSettings.url||delete r.ajaxSettings.url),r},r}();exports.PdSDKUtils=PdSDKUtils;