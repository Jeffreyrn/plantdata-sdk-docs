"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var $=require("jquery"),prefix_1=require("../prefix"),elecreator_1=require("../../../core/elecreator"),PdUITab=function(){function e(){}return e.init=function(){e.bindEvent(),e.updateAllTabNav()},e.updateAllTabNav=function(){$(e.clsNav).each(function(a,t){e.updateTabNav($(t))})},e.updateTabNav=function(a){var t=a.closest("."+e.clsNavContainerName);if(t.length){var l="width",r="outerWidth",s="left",c="margin-"+s;e.isVertical(a)&&(l="height",r="outerHeight",s="top",c="margin-"+s);var i=0;a.children("li:not(."+e.clsNavDecorationName+")").each(function(e,a){i+=Math.ceil($(a)[r]())});var o=t[l]();if(t.toggleClass(e.clsNavShowAllName,o>=i),o<i){a[l](i);var n=a.children("li.active"),v=n.position()[s],N=parseInt(a.css(c),10);v+N<0?N=-v:v+n[r]()+N>o&&(N=o-n[r]()-v);var m=a[l]();o>m+N&&N<0&&(N=o-m),a.css(c,N);var u=e.getControlStatus(a,N);e.setControlStatus(a,u.prev,u.next)}}else;},e.bindEvent=function(){var a=">."+e.clsNavContainerName+":not(."+e.clsNavShowAllName+")>."+e.clsNavWrapName;$("body").on("click",e.clsNav+">li:not(.disabled)",function(a){var t=$(a.currentTarget),l=t.find("a").attr("href");t=$('a[href="'+l+'"]').closest("li");var r=$(l),s=r.siblings(".active"),c="#"+s.attr("id"),i=$('a[href="'+c+'"]').closest("li");t.addClass("active"),r.addClass("active"),i.removeClass("active"),s.removeClass("active"),t.each(function(a,t){var l=$(t);e.updateTabNav(l.closest(e.clsNav)),e.setDecorationPos(l)}),i.each(function(a,t){var l=$(t);l.siblings(".active").length||e.setDecorationPos(l)})}).on("click","."+e.clsNavControlPrevName+":not(.disabled)",function(a){var t=$(a.currentTarget),l=t.siblings("."+e.clsNavWrapName),r=e.isVertical(t),s="outerWidth";r&&(s="outerHeight");var c=l[s]();e.setVisiblePos(l,c,r)}).on("click","."+e.clsNavControlNextName+":not(.disabled)",function(a){var t=$(a.currentTarget),l=t.siblings("."+e.clsNavWrapName),r=e.isVertical(t),s="outerWidth";r&&(s="outerHeight");var c=l[s]();e.setVisiblePos(l,-c,r)}).on("mousewheel","."+e.clsLeftName+a+",."+e.clsRightName+a,function(a){var t=$(a.currentTarget);e.setVisiblePos(t,a.deltaY*a.deltaFactor,!0)}),$(window).resize(function(){e.updateAllTabNav()})},e.getControlStatus=function(a,t){var l=a.parent(),r="width",s="margin-left";return e.isVertical(a)&&(r="height",s="margin-top"),t=void 0===t?parseInt(a.css(s),10):t,{prev:t<0,next:l[r]()-t<a[r]()}},e.isVertical=function(a){return a.closest("."+e.clsNavContainerName).parent("."+e.clsLeftName+",."+e.clsRightName).length>0},e.setControlStatus=function(a,t,l){if(void 0===t||void 0===l){var r=e.getControlStatus(a);t=r.prev,l=r.next}var s=a.parent();s.siblings("."+e.clsNavControlPrevName).toggleClass("disabled",!t),s.siblings("."+e.clsNavControlNextName).toggleClass("disabled",!l)},e.setDecorationPos=function(a){var t=e.isVertical(a),l="width",r="outerWidth",s="left";t&&(l="height",r="outerHeight",s="top");var c=a.siblings("."+e.clsNavDecorationName);if(a.hasClass("active")){var i=a[r]();c[l](i);var o=a.position()[s];c.css(s,o)}else if(a.length){var i=c[r]();c[l](0);var o=c.position()[s];c.css(s,o+i/2)}else c.css(s,0)},e.setVisiblePos=function(a,t,l){var r=a.children("ul"),s="outerWidth",c="margin-left";l&&(s="outerHeight",c="margin-top");var i=a[s](),o=r[s]()-i,n=parseInt(r.css(c),10),v=n+t,N=v>-o?v:-o;N=N<0?N:0,r.css(c,N),e.setControlStatus(r,0!==N,N!==-o)},e.updateAllControlStatus=function(){$(e.clsNav).each(function(a,t){e.setControlStatus($(t))})},e.updateTabNavContainer=function(a){if(!a.parent("."+e.clsNavWrapName).length){var t=elecreator_1.PdEleCreator.createEle("div",{cls:e.clsNavWrapName}),l=elecreator_1.PdEleCreator.createEle("div",{cls:e.clsNavContainerName}),r=elecreator_1.PdEleCreator.createEle("div",{cls:e.clsNavControlName+" "+e.clsNavControlPrevName})+elecreator_1.PdEleCreator.createEle("div",{cls:e.clsNavControlName+" "+e.clsNavControlNextName}),s=elecreator_1.PdEleCreator.createEle("li",{cls:e.clsNavDecorationName}),c=$(s);a.wrap(l).after(r).wrap(t),a.append(c);var i=a.children("li.active");e.setDecorationPos(i)}},e.clsName=prefix_1["default"].cls+"tab",e.cls="."+e.clsName,e.clsLeftName=e.clsName+"-left",e.clsRightName=e.clsName+"-right",e.clsNavName=e.clsName+"-nav",e.clsNav="."+e.clsNavName,e.clsNavContainerName=e.clsName+"-nav-container",e.clsNavShowAllName=e.clsName+"-nav-show-all",e.clsNavControlName=e.clsName+"-nav-control",e.clsNavControlPrevName=e.clsName+"-nav-control-prev",e.clsNavControlNextName=e.clsName+"-nav-control-next",e.clsNavWrapName=e.clsName+"-nav-wrap",e.clsNavDecorationName=e.clsName+"-nav-decoration",e.clsNavPrimaryName=e.clsName+"-nav-primary",e.clsNavSecondaryName=e.clsName+"-nav-secondary",e.clsNavItemName=e.clsName+"-nav-item",e.clsPageName=e.clsName+"-page",e.clsPageItemName=e.clsName+"-page-item",e}();exports.PdUITab=PdUITab,$(function(){PdUITab.init()});