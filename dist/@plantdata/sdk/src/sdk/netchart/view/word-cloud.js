"use strict";var __extends=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}();Object.defineProperty(exports,"__esModule",{value:!0});var $=require("jquery"),lodash_1=require("lodash"),local_parking_1=require("../../../icon/local-parking"),view_1=require("../../../vis/netchart/view"),word_cloud_1=require("../../stats/impls/word-cloud"),PdSDKViewWordCloud=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.getViewType=function(){return"wordCloudView"},e.prototype.bindEvent=function(){t.prototype.bindEvent.call(this)},e.prototype.dataChange=function(){var t=this,e=this.select(".pdvis-word-cloud-view-body");if(this.data){for(var o=[],i=function(t){var e=lodash_1.filter(n.data.links,function(e){return e.from===t.id||e.to===t.id});o.push({name:t.name,value:e.length,id:t.id,type:"node"})},n=this,r=0,a=this.data.nodes;r<a.length;r++){var d=a[r];i(d)}var s=lodash_1.countBy(this.data.links,"attName");for(var u in s)s.hasOwnProperty(u)&&o.push({name:u,value:s[u],type:"link"});this.stat=new word_cloud_1.PdSDKStatWordCloud({data:{series:o},type:"wordCloud",selector:e}),this.stat.chart.on("dblclick",function(e){"node"===e.data.type&&t.settings.sdkNetChart.load({id:e.data.id})})}else{var l=this.createNoData();e.html(l)}},e.prototype.enter=function(){var t=this;setTimeout(function(){t.stat&&t.stat.resize()},300)},e.prototype.initSettings=function(o){return $.extend(!0,{},t.prototype.initSettings.call(this,e.defaultSettings),o)},e.prototype.initTemplate=function(){var t=$('<div class="pdvis-word-cloud-view-body"></div>');return this.initViewTemplate(t,"文本词云",local_parking_1["default"]()).addClass("pdvis-word-cloud-view-container")},e.prototype.mounted=function(){t.prototype.mounted.call(this),this.bindEvent()},e.defaultSettings={},e}(view_1.PdVisView);exports.PdSDKViewWordCloud=PdSDKViewWordCloud;