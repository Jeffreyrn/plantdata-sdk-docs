"use strict";var __extends=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function a(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();Object.defineProperty(exports,"__esModule",{value:!0});var $=require("jquery"),lodash_1=require("lodash"),editor_define_attribute_1=require("./editor-define-attribute"),utils_1=require("../../../utils"),format_list_bulleted_1=require("../../../../icon/format-list-bulleted"),PdSDKEditorDefineAttributeConcept=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.openAddDialog=function(t){this.attributeListData=[],this.data=t,this.addDialog.open()},e.prototype.updateStatusBySelection=function(t,e,i){if(1===t.length&&0===e.length){var a=t[0];1===a.type?(this.updateStatus(!1),this.updateVisibility(!1)):0===a.type&&(this.data=a,this.updateStatus("0"!==a.id.toString()),this.updateVisibility(!0))}else this.updateStatus(!1),this.updateVisibility(!1)},e.prototype.addAttribute=function(t){var e=this.settings.ajaxSettings,i=e.queryData||{},a=e.formData||{};i.kgName=this.settings.kgName;var r=t;r.domain=this.data.id,r.type=this.settings.attributeType,a.attDefJson=JSON.stringify(r);var s={url:e.baseUrl+"attribute/addOrUpdate/definition",type:"POST",data:a};return s=$.extend(!0,{},s,e,this.settings.addAttributeSettings),s.url=utils_1.PdSDKUtils.buildUrl(s.url,i),utils_1.PdSDKUtils.ajax(s)},e.prototype.deleteAttribute=function(t){var e=this.settings.ajaxSettings,i=e.queryData||{},a=e.formData||{};i.kgName=this.settings.kgName,a.id=t;var r={url:e.baseUrl+"attribute/delete/definition",type:"POST",data:a};return r=$.extend(!0,{},r,e,this.settings.deleteAttributeSettings),r.url=utils_1.PdSDKUtils.buildUrl(r.url,i),utils_1.PdSDKUtils.ajax(r)},e.prototype.getAttributeList=function(){var t=this.settings.ajaxSettings,e=t.queryData||{};e.kgName=this.settings.kgName,e.id=this.data.id,e.type="0";var i={url:t.baseUrl+"attribute/get/definition",type:"GET"};return i=$.extend(!0,{},i,t,this.settings.attributeListSettings),i.url=utils_1.PdSDKUtils.buildUrl(i.url,e),utils_1.PdSDKUtils.ajax(i)},e.prototype.updateAttribute=function(t){var e=this.settings.ajaxSettings,i=e.queryData||{},a=e.formData||{};i.kgName=this.settings.kgName;var r=t;r.type=this.settings.attributeType,a.attDefJson=JSON.stringify(r);var s={url:e.baseUrl+"attribute/addOrUpdate/definition",type:"POST",data:a};return s=$.extend(!0,{},s,e,this.settings.updateAttributeSettings),s.url=utils_1.PdSDKUtils.buildUrl(s.url,i),utils_1.PdSDKUtils.ajax(s)},e.prototype.getEditFormSettings=function(){return[{type:"custom",key:"domain",label:"定义域",mode:"label",html:'<div class="pdsdk-editor-define-attribute-modify-domain-select"></div>'},{type:"input",key:"name",label:"名称",mode:"label",required:!0},{type:"custom",key:"dataType",label:"数据类型",mode:"label",html:'<div class="pdsdk-editor-define-attribute-modify-select"></div>'},{type:"input",key:"dataUnit",label:"单位",mode:"label",disabled:!0}]},e.prototype.initSettings=function(i){var a=$.extend(!0,{},e.defaultSettings);return $.extend(!0,{},t.prototype.initSettings.call(this,a),i)},e.prototype.onClick=function(t){var e=this;this.getAttributeList().then(function(t){var i=lodash_1.filter(t.rsData,["type",e.settings.attributeType]);e.attributeListData=i,e.drawAttributeList(i)}),this.$attributeList.find(".pdsdk-editor-define-attribute-name").text(this.data.name).attr("title",this.data.name),this.$attributeList.removeClass("hide")},e.defaultSettings={attributeType:"0",key:"id",cls:["pd-btn-float"],name:"defineAttribute",title:"属性定义",disabled:!0,visible:!1,icon:format_list_bulleted_1["default"](20),localization:{tableTitle1:"关系名称",tableTitle2:"值域",tableTitle3:"属性类型",listTitle:"属性",listType:"数值"}},e}(editor_define_attribute_1.PdSDKEditorDefineAttribute);exports.PdSDKEditorDefineAttributeConcept=PdSDKEditorDefineAttributeConcept;