"use strict";var __extends=this&&this.__extends||function(){var t=function(o,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)o.hasOwnProperty(e)&&(t[e]=o[e])})(o,e)};return function(o,e){function n(){this.constructor=o}t(o,e),o.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0});var $=require("jquery"),lodash_1=require("lodash"),button_1=require("../../../ui/components/button/button"),common_1=require("../../../common/common"),prompt_1=require("../../prompt/prompt"),tag_complex_editor_1=require("../../../vis/utils/tag-editor/tag-complex-editor"),PdSDKTagPrompt=function(t){function o(o){return t.call(this,o)||this}return __extends(o,t),o.prototype.dataToValue=function(t){return t},o.prototype.existData=function(t){var o=this;return!!lodash_1.find(this.data,function(e){return e[o.settings.valueKey].toString()===t[o.settings.valueKey].toString()})},o.prototype.valueToData=function(t){return t},o.prototype.bindEvent=function(){var o=this;t.prototype.bindEvent.call(this),this.$editor.on("click",".pdvis-tag-control",function(){var t=o.$prompt.autocomplete.getSelectedItem();t?o.addData(t).then(function(){o.$prompt.autocomplete.clear()},function(t){common_1.PdCommonUtils.error(t)}):common_1.PdCommonUtils.error("请选择一个项目后再进行添加操作")})},o.prototype.createEditor=function(){var t='<div class="pdsdk-tag-prompt-input"></div>';return this.settings.addOnSelect||(t+=button_1.PdUIButton.create({html:"添加",size:this.settings.size,type:"primary",cls:"pdvis-tag-control"})),$('<div class="pdvis-tag-editor-editor pdsdk-tag-prompt-editor">'+t+"</div>")},o.prototype.initSettings=function(e){return $.extend(!0,{},t.prototype.initSettings.call(this,o.defaultSettings),e)},o.prototype.initTemplate=function(){var o=t.prototype.initTemplate.call(this);return o.addClass("pdsdk-tag-prompt"),o},o.prototype.mounted=function(){var o=this,e=$.extend(!0,{autocompleteSettings:{size:this.settings.size,onSearch:function(t){o.settings.addOnSelect&&o.addData(t).then(function(){o.$prompt.autocomplete.clear()},function(t){common_1.PdCommonUtils.error(t)})}}},this.settings.promptSettings,{selector:this.select(".pdsdk-tag-prompt-input")});this.$prompt=new prompt_1.PdSDKPrompt(e),t.prototype.mounted.call(this)},o.prototype.unbindEvent=function(){t.prototype.unbindEvent.call(this),this.$editor.off("click",".pdvis-tag-control")},o.defaultSettings={promptSettings:{autocompleteSettings:{theme:"normal"}},addOnSelect:!0},o}(tag_complex_editor_1.PdVisTagComplexEditor);exports.PdSDKTagPrompt=PdSDKTagPrompt;