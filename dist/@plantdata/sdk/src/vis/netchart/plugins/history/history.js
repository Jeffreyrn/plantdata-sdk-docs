"use strict";var __extends=this&&this.__extends||function(){var t=function(i,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(i,e)};return function(i,e){function s(){this.constructor=i}t(i,e),i.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)}}();Object.defineProperty(exports,"__esModule",{value:!0});var $=require("jquery"),plugin_1=require("../plugin"),access_time_1=require("../../../../icon/access-time"),PdVisPluginHistory=function(t){function i(i){return t.call(this,i)||this}return __extends(i,t),i.prototype.getPluginType=function(){return"history"},i.prototype.bindEvent=function(){var i=this;t.prototype.bindEvent.call(this),this.drawItems(),this.addEvent("beforedraw",function(){i.drawItems()}),this.select(".pdvis-float-item-head").on("click",function(t){var i=$(t.target).closest(".pdvis-panels-float-item").toggleClass("active");i.siblings(".pdvis-panels-float-item").removeClass("active")}),this.select(".pdvis-float-item-detail").on("click",".pdvis-history-item",function(t){i.container.goHistory($(t.target).index())})},i.prototype.created=function(){var i={};this.settings=$.extend(!0,{},i,this.settings),t.prototype.created.call(this)},i.prototype.drawItem=function(t,i){var e=t.loadParams,s=i?"pdvis-history-select":"";if(!this.settings.drawItem){var o="";if(e.name)o=e.name;else if(e){var n=this.container.findNodeAdvance(e);n&&(o=n.name)}return'<div class="pdvis-history-item '+s+'" title="'+o+'"><i></i>'+o+"</div>"}this.settings.drawItem(t,s)},i.prototype.drawItems=function(){var t=this.container.historyList;this.select(".pdvis-history").empty();for(var i in t)if(t.hasOwnProperty(i)){var e=t[i],s=parseInt(i,10)===this.container.historyCursor,o=$(this.drawItem(e,s)).data("data",e);this.select(".pdvis-history").append(o)}},i.prototype.initSettings=function(e){return $.extend(!0,{},t.prototype.initSettings.call(this,i.defaultSettings),e)},i.prototype.initTemplate=function(){var t="历史",i=$('<div class="pdvis-history-container"></div>'),e=access_time_1["default"](20);return i.append('<div class="pdvis-float-item-head"><div class="pdvis-panels-icon" data-pdui-tooltip="hover" data-pdui-tooltip-position="bottom" title="'+t+'">'+e+'</div><div class="pdvis-panels-tooltip">'+t+'</div></div><div class="pdvis-float-item-detail"><div class="pdvis-history"></div></div>'),this.buildPluginTemplate(i,e,t)},i.prototype.mounted=function(){t.prototype.mounted.call(this),this.bindEvent()},i.prototype.unbindEvent=function(){t.prototype.unbindEvent.call(this),this.select(".pdvis-float-item-head").off("click"),this.select(".pdvis-float-item-detail").off("click",".pdvis-history-item")},i.defaultSettings={side:"top",isFloat:!0},i}(plugin_1.PdVisPlugin);exports.PdVisPluginHistory=PdVisPluginHistory;