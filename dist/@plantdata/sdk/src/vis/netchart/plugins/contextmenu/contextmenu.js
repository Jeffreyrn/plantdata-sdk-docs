"use strict";var __extends=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(exports,"__esModule",{value:!0});var $=require("jquery"),toolbox_1=require("../toolbox/toolbox"),contextmenu_item_1=require("./contextmenu-item/contextmenu-item"),common_1=require("../../../../common/common"),PdVisPluginContextmenu=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.getPluginType=function(){return"contextmenu"},e.prototype.beforeShow=function(t){return!0},e.prototype.bindEvent=function(){var e=this;t.prototype.bindEvent.call(this),this.container.$el[0].oncontextmenu=function(t){return e.hide(),!$(t.target).is(".pdvis-tool-item")},this.addEvent("rightClick",function(t){e.handleRightClick(t)}),this.addEvent("click",function(t){e.hide()})},e.prototype.createToolItemSettings=function(t){var e=this;return t&&t.children?$.extend(!0,{netChart:this.container},t):$.extend(!0,{netChart:this.container,afterClick:function(){e.hide()}},t)},e.prototype.createGeneralToolItem=function(t){return new contextmenu_item_1.PdVisContextmenuItem(this.createToolItemSettings(t))},e.prototype.handleRightClick=function(t){var e=this;setTimeout(function(){if(e.beforeShow(t)){e.show();var n=e.panel.$el.offset(),o=n.left,i=n.top;o=(t.x||0)-o,i=(t.y||0)-i;var r=e.$el.width(),u=e.$el.height(),c=common_1.PdCommonUtils.getViewport();o+r>c.left+c.width&&(o=c.left+c.width-r),i+u>c.top+c.height&&(i=c.top+c.height-u),e.$el.css({left:o,top:i})}},0)},e.prototype.initSettings=function(n){return $.extend(!0,{},t.prototype.initSettings.call(this,e.defaultSettings),n)},e.prototype.initTemplate=function(){var t="",e="",n=this.createContainer("pdvis-contextmenu-container hide");return this.buildPluginTemplate(n,e,t)},e.defaultSettings={side:"mask",isFloat:!0},e}(toolbox_1.PdVisPluginToolBox);exports.PdVisPluginContextmenu=PdVisPluginContextmenu;