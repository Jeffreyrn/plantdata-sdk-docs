"use strict";var __extends=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(exports,"__esModule",{value:!0});var lodash_1=require("lodash"),legend_1=require("../legend"),PdVisPluginNodeLegend=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.legendIds=[],t}return __extends(t,e),t.prototype.getPluginType=function(){return"nodeLegend"},t.prototype.bindEvent=function(){var t=this;this.addEvent("nodelegendupdate",function(e){lodash_1.isEqual(e.legends,t.settings.data)||t.replaceData(e.legends)}),this.addEvent("beforedraw",function(){t.container.getData()&&(t.nodeData=t.container.getData().nodes)},this.container,"node"),e.prototype.bindEvent.call(this)},t.prototype.buildLegendItem=function(t){var n=e.prototype.buildLegendItem.call(this,t);return n.addClass("pdvis-legend-node-item"),t.outline&&n.addClass("pdvis-legend-item-outline"),t.dashed&&n.addClass("pdvis-legend-item-dashed"),n},t.prototype.created=function(){if(e.prototype.created.call(this),this.settings.data)for(var t=0,n=this.settings.data;t<n.length;t++){var o=n[t];o.key=o.key.toString()}},t.prototype.filter=function(e){return!!this.settings.showAllLegend||lodash_1.indexOf(this.legendIds,e.key)>=0},t.prototype.initTemplate=function(){return e.prototype.initTemplate.call(this).addClass("pdvis-node-legend")},t.prototype.legendDraw=function(){if(this.nodeData){var t=lodash_1.map(this.nodeData,"classId");this.legendIds=lodash_1.uniq(t),e.prototype.legendDraw.call(this)}},t.prototype.legendUpdate=function(){this.container.updateNodeLegend(this.settings.data),this.container.updateChart()},t.prototype.mounted=function(){this.container.getData()&&(this.nodeData=this.container.getData().nodes),e.prototype.mounted.call(this)},t}(legend_1.PdVisPluginLegend);exports.PdVisPluginNodeLegend=PdVisPluginNodeLegend;