"use strict";var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0});var $=require("jquery"),main_1=require("./panels/tab/main/main"),component_1=require("../core/component"),side_1=require("./panels/tab/side/side"),float_1=require("./panels/float/float"),PdContainer=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.destroy=function(){this.mainPanel.destroy();for(var t in this.sidePanels)this.sidePanels.hasOwnProperty(t)&&this.sidePanels[t].destroy();e.prototype.destroy.call(this)},t.prototype.getMainPanel=function(){return this.mainPanel},t.prototype.getSidePanel=function(e,t){if(this.sidePanels||(this.sidePanels={}),"mask"===e){var i=this.sidePanels.top;if(!i){var n={side:"mask"},a=this.settings.panelSettings;a&&a.top&&(n=a.top),i=new float_1.PdFloatPanel(n),this.sidePanels.top=i,this.mainPanel.$el.before(i.$el)}return i}if(t){var i=this.sidePanels[e+"-float"];return i?i:this.createFloatPanel(e)}var i=this.sidePanels[e];return i?i:this.createSidePanel(e)},t.prototype.addMainPanel=function(e,t){return this.mainPanel.addChild(e,t)},t.prototype.createFloatPanel=function(e){var t=e+"-float",i=this.settings[e+"FloatPanel"]||{},n=this.settings.panelSettings;n&&n["float"]&&n["float"][e]&&(i=$.extend(!0,i,n["float"][e])),i.side=e;var a=new float_1.PdFloatPanel(i);return this.sidePanels[t]=a,this.mainPanel.$el.before(a.$el),a},t.prototype.createMainPanel=function(){var e=this;this.mainPanel=new main_1.PdMainPanel({onTabChange:function(t,i){e.$el.attr("data-pdview",t.data.type),e.dispatch("viewChange",{from:i,to:t})}}),this.$el.prepend(this.mainPanel.$el),this.initMainPanel()},t.prototype.createPanels=function(){this.createMainPanel(),this.sidePanels={},this.createFloatPanel("bottom"),this.createFloatPanel("top"),this.createFloatPanel("left"),this.createFloatPanel("right"),this.createSidePanel("right"),this.createSidePanel("left")},t.prototype.createSidePanel=function(e){var t=this,i=this.settings[e+"Panel"]||{},n=this.settings.panelSettings;n&&n.side&&n.side[e]&&(i=$.extend(!0,i,n["float"][e])),i.side=e;var a=new side_1.PdSidePanel(i);return this.sidePanels[e]=a,this.sidePanels[e].on("visibleChange",function(e){t.sidePanelVisibleChangeHandler(e)}),this.$el.prepend(a.$el),a},t.prototype.hideMask=function(){var e=this.select(".pdvis-mask");return e.removeClass("active"),setTimeout(function(){e.addClass("hide")},300),e},t.prototype.hidePanel=function(e){var t=this;"overlay"===e.settings.mode?this.hideMask().off("click"):"fixed"===e.settings.mode&&setTimeout(function(){t.dispatch("resize",t.eventData)},300)},t.prototype.initMainPanel=function(){this.addMainPanel('<div class="pdvis-main-container"></div>',{active:!0}),this.$mainContainer=this.select(".pdvis-main-container")},t.prototype.initTemplate=function(){var e=$(this.settings.selector);return this.saveOriginClass(e),e.addClass("pdvis pdvis-namespace").html('<div class="pdvis-mask hide"></div>'),e},t.prototype.mounted=function(){e.prototype.mounted.call(this),this.createPanels()},t.prototype.showMask=function(){var e=this.select(".pdvis-mask");return e.removeClass("hide"),setTimeout(function(){e.addClass("active")},0),e},t.prototype.showPanel=function(e){var t=this;"overlay"===e.settings.mode?this.showMask().one("click",function(){e.hideActivePanel(),t.hideMask()}):"fixed"===e.settings.mode&&setTimeout(function(){t.dispatch("resize",t.eventData)},300)},t.prototype.sidePanelVisibleChangeHandler=function(e){e.visible?this.showPanel(e.self):this.hidePanel(e.self)},t}(component_1.PdComponent);exports.PdContainer=PdContainer;